# 請求書自動作成 Webアプリ（Streamlit）

## 概要

このアプリは、日付と請求対象のテキストを入力すると、ドライバーごとの請求額・高速代を自動で抽出し、整形された請求書（Excelファイル）を生成・ダウンロードできるツールです。

- フロントエンド：Streamlit
- 出力形式：`.xlsx`（openpyxlで生成）
- 主な用途：運送業の精算書やドライバーへの請求書作成

---

## 特徴

- `MM/DD`形式の日付入力に対応（自動で和暦に変換）
- 請求対象テキストから正規表現で必要情報を抽出
- 金額に応じた消費税・合計額も自動計算
- 曜日もExcel関数で自動挿入（=CHOOSE(WEEKDAY(...))）
- 整形されたフォント・罫線付きのExcelファイルをダウンロード可能

---

## 使用方法

1. Streamlitを起動：
   ```bash
   streamlit run app.py
   ```
2. 入力フォームに以下を記入：

   * `作成したい請求書の日付`：MM/DD（例：06/12）
   * `処理するテキスト`：各ドライバーの明細を含むテキスト

3. 「請求書作成」ボタンをクリックで `.xlsx` ファイルがダウンロードされます。

---

## 入力データの形式（例）

```text
08時00分～17時00分 田中
...
求：123,456円 高速：1,230円
```

* 時間が2つ以上含まれる行：ドライバーの開始行と判定
* 漢字2文字 or カタカナ3文字の名前を抽出
* 「求」＋「高速」が含まれる行から金額を抽出

---

## 出力項目（Excel）

| 日付         | 曜日 | 案件名  | 内容     | 担当 | 車種   | 単価      | 消費税      | 高速代    | 合計        |
| ---------- | -- | ---- | ------ | -- | ---- | ------- | -------- | ------ | --------- |
| 2025/MM/DD | 月等 | 川崎DC | 時間貸し輸送 | 山田 | 4t冷蔵 | ¥30,000 | =G5\*0.1 | ¥1,000 | =G5+H5+I5 |

---

## ファイル構成

```
project/
├── app.py                # 本体コード
├── requirements.txt      # 必要ライブラリ一覧
```

---

## 必要ライブラリ

```bash
pip install streamlit openpyxl
```

---

## 注意点

* ファイル名にスラッシュ (`/`) が入るとダウンロード時に不具合が出るため、`_` に変換済み
* Streamlit環境では、アップロードしたファイルのサイズ制限に注意

---

## ライセンス

MIT License

```

必要であればこの `README.md` をそのまま `GitHub` のルートディレクトリに設置してください。追加項目（例：環境変数やデモ動画リンクなど）があれば教えてもらえれば追記できます。
```
